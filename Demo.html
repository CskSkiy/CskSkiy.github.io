<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Demo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 40px;
      background: #f0f0f0;
    }

    h2 {
      margin-bottom: 40px;
    }

    .switch-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .switch-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 26px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 26px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #4CAF50;
    }

    input:checked + .slider:before {
      transform: translateX(24px);
    }

    button {
      margin-top: 30px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background-color: #2196F3;
      color: white;
      border: none;
      border-radius: 5px;
    }

    /* Modal styles */
    .modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .modal-buttons {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .modal-buttons button {
      padding: 8px 14px;
      font-size: 14px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .confirm-btn { background-color: #4CAF50; color: white; }
    .cancel-btn { background-color: #f44336; color: white; }
    .neutral-btn { background-color: #9e9e9e; color: white; }
}
  </style>
</head>
<body>
  <h2>é¸æ“‡æ‚¨çš„è«‹æ±‚</h2>

  <div class="switch-group">
    <div class="switch-container">
      <label class="switch">
        <input type="checkbox" id="switch1" />
        <span class="slider"></span>
      </label>
      <span>å“è³ªå¥½</span>
    </div>
    <div class="switch-container">
      <label class="switch">
        <input type="checkbox" id="switch2" />
        <span class="slider"></span>
      </label>
      <span>ä¾¿å®œé»</span>
    </div>
    <div class="switch-container">
      <label class="switch">
        <input type="checkbox" id="switch3" />
        <span class="slider"></span>
      </label>
      <span>åšå¿«é»</span>
    </div>
  </div>

  <button onclick="handleConfirm()">ç¢ºèª</button>

  <div id="modal" class="modal">
    <div class="modal-content">
      <div id="modal-message"></div>
      <div class="modal-buttons" id="modal-buttons"></div>
    </div>
  </div>

  <script>
    const switches = {
      switch1: document.getElementById("switch1"),
      switch2: document.getElementById("switch2"),
      switch3: document.getElementById("switch3"),
    };

    let allowThree = false;

    function getSelected() {
      return Object.entries(switches)
        .filter(([_, cb]) => cb.checked)
        .map(([id, _]) => id);
    }

    function handleSwitchChange(changedId) {
      const selected = getSelected();

      if (selected.length > 3) return; // safety check

      if (selected.length === 3) {
        if (!allowThree) {
          // å–æ¶ˆé™¤äº†changedIdä»¥å¤–çš„å…¶ä¸­ä¸€å€‹å·²é¸å–çš„ switch
          const others = selected.filter((id) => id !== changedId);
          const toUncheck = others[Math.floor(Math.random() * others.length)];
          switches[toUncheck].checked = false;
        }
      }

      // 15%æ©Ÿç‡æš«æ™‚è§£é™¤ä¸‰é¸é™åˆ¶
      if (selected.length === 3 && !allowThree && Math.random() < 0.15) {
        allowThree = true;
      }

      // å¦‚æœå¾ä¸‰é¸å›åˆ°å…©é¸ï¼Œæ¢å¾©é™åˆ¶
      if (selected.length === 2 && allowThree) {
        allowThree = false;
      }
    }

    // ç¶å®šäº‹ä»¶
    Object.keys(switches).forEach((id) => {
      switches[id].addEventListener("change", () => handleSwitchChange(id));
    });

	function disablePage() {
 	 // æ¸…ç©º body å…§å®¹
	  document.body.innerHTML = "<h2>å¦è«‹é«˜æ˜å§ğŸ˜…</h2>";
	  // æ”¹è®Š body æ¨£å¼ï¼Œè®“æ¸¸æ¨™è®Šæˆç¦ç”¨ç‹€æ…‹
	  document.body.style.cursor = "not-allowed";
	  // ç¦æ­¢æ»‘é¼ é»æ“Šå’Œéµç›¤äº‹ä»¶
	  document.body.style.pointerEvents = "none";
	  // è‹¥éœ€è¦ï¼Œé‚„å¯ä»¥ç¦æ­¢æ»¾å‹•
 	 document.body.style.overflow = "hidden";
	}

    // å½ˆçª—é¡¯ç¤º
    function showModal(message, buttons) {
      const modal = document.getElementById("modal");
      const msgBox = document.getElementById("modal-message");
      const btnBox = document.getElementById("modal-buttons");

      msgBox.innerHTML = message;
      btnBox.innerHTML = "";

      buttons.forEach((btn) => {
        const button = document.createElement("button");
        button.textContent = btn.text;
        button.className = btn.class;
        button.onclick = () => {
          modal.style.display = "none";
          btn.onClick();
        };
        btnBox.appendChild(button);
      });

      modal.style.display = "flex";
    }

    // ç¢ºèªæŒ‰éˆ•é‚è¼¯
    function handleConfirm() {
      const selected = getSelected();
      const labelMap = {
        switch1: "good",
        switch2: "cheap",
        switch3: "fast",
      };
      const values = selected.map((id) => labelMap[id]);
      const set = new Set(values);

      if (selected.length === 0) {
        showModal("æ„Ÿè¬æ‚¨ã€‚", [
          { text: "æˆ‘çŸ¥é“äº†", class: "neutral-btn", onClick: () => {} },
        ]);
        return;
      }

      if (selected.length === 1) {
        showModal("æˆ‘å€‘æœƒç›¡é‡é”æˆæ‚¨çš„è¦æ±‚ :)", [
          { text: "æˆ‘çŸ¥é“äº†", class: "neutral-btn", onClick: () => {} },
	  { text: "æˆ‘å†æƒ³æƒ³", class: "cancel-btn", onClick: () => {} },
        ]);
        return;
      }

      if (selected.length === 2) {
        // good + cheap
        if (set.has("good") && set.has("cheap")) {
          // å…©æ®µæµç¨‹å¤šæŒ‰éˆ•
          let step = 1;
          function step1() {
            showModal("é€™æ¨£è¦æ±‚æœƒå°è‡´æº–å‚™æ™‚é–“å¤§å¹…æ‹‰é•·ï¼Œä½ ç¢ºå®šï¼Ÿ", [
              { text: "æˆ‘ç¢ºå®š", class: "confirm-btn", onClick: step2 },
              { text: "ç®—äº†å§ï¼Œæˆ‘å–æ¶ˆ", class: "cancel-btn", onClick: () => {} },
            ]);
          }
          function step2() {
            showModal("è«‹æ‚¨ç­‰å€™ï¼Œæˆ‘å€‘å°‡ç›¡å¿«ç‚ºæ‚¨è™•ç†ã€‚:)", [
              {
                text: "ç®—äº†å§ï¼Œæˆ‘å–æ¶ˆ",
                class: "cancel-btn",
                onClick: () => {},
              },
              {
                text: "æˆ‘ä¸æƒ³ç­‰ï¼Œå¿«ä¸€é»",
                class: "confirm-btn",
                onClick: step3,
              },
              { text: "æˆ‘çŸ¥é“äº†", class: "neutral-btn", onClick: () => {} },
            ]);
          }
          function step3() {
            showModal("ä½ é€™ç„¡è‰¯ç”²æ–¹ï¼Œè¦å¥½è¦ä¾¿å®œé‚„ä¸é¡˜æ„ç­‰å–”ï¼Ÿæˆ‘ä¹Ÿç­‰ä¸åŠä½ æ—©é»å»æŠ•èƒğŸ˜…ğŸ–•", [
              {
                text: "ï¼Ÿ",
                class: "cancel-btn",
                onClick: disablePage,
              },
            ]);
          }
          step1();
          return;
        }

        // good + fast
        if (set.has("good") && set.has("fast")) {
          let step = 1;
          const price =
            Math.floor(Math.random() * (50 - 5 + 1) + 5) * 1000; // 5000~50000åƒä½æ•´æ•¸

          function step1() {
            showModal(`é€™æ¨£è¦æ±‚æœƒå°è‡´é‡‘é¡å¤§å¹…å¢åŠ ï¼Œä½ ç¢ºå®šï¼Ÿ`, [
              { text: "æˆ‘ç¢ºå®š", class: "confirm-btn", onClick: step2 },
              { text: "æˆ‘å†æƒ³æƒ³", class: "cancel-btn", onClick: () => {} },
            ]);
          }
          function step2() {
            showModal(
              `é‡‘é¡ç‚º <strong>${price.toLocaleString()}</strong>ï¼Œä»˜éŒ¢å¾Œï¼Œæˆ‘å€‘å°‡ç‚ºæ‚¨è™•ç†ã€‚:)`,
              [
                {
                  text: "ç®—äº†å§ï¼Œæˆ‘å–æ¶ˆ",
                  class: "cancel-btn",
                  onClick: () => {},
                },
                {
                  text: "æˆ‘ä¸æƒ³èŠ±é€™éº¼å¤šéŒ¢ï¼Œæ®ºåƒ¹",
                  class: "confirm-btn",
                  onClick: step3,
                },
                { text: "æˆ‘çŸ¥é“äº†", class: "neutral-btn", onClick: () => {} },
              ]
            );
          }
          function step3() {
            showModal("ä½ é€™è‰¯å¿ƒç‹—å•ƒæ…£è€é—†ï¼Œè¦å¥½è¦å¿«ä¸çµ¦éŒ¢ï¼Œé¤Šé¦¬çš„æƒ³è¦é¦¬å¿«éƒ½çŸ¥é“è¦çµ¦è‰åƒï¼Œå°±ä½ ä¸çŸ¥é“ï¼Œå¯æ†ğŸ˜…ğŸ–•", [
              {
                text: "ï¼Ÿ",
                class: "cancel-btn",
                onClick: disablePage,
              },
            ]);
          }
          step1();
          return;
        }

        // cheap + fast
        if (set.has("cheap") && set.has("fast")) {
          let step = 1;
          function step1() {
            showModal(
              `é€™æ¨£è¦æ±‚æœƒå°è‡´å“è³ªå¤§å¹…é™ä½ï¼Œä½ ç¢ºå®šï¼Ÿ`,
              [
                { text: "æˆ‘ç¢ºå®š", class: "confirm-btn", onClick: step2 },
                { text: "æˆ‘å†æƒ³æƒ³", class: "cancel-btn", onClick: () => {} },
              ]
            );
          }
          function step2() {
            showModal(`é€™æ˜¯æ‚¨é¸æ“‡çš„ <a href="https://youtu.be/dQw4w9WgXcQ?si=5gFjDn78xSUHhbe5" target="_blank" rel="noopener noreferrer">ç‰©å“</a>ï¼Œè«‹å…ˆç¢ºèªã€‚:)`, [
              {
                text: "ç®—äº†å§ï¼Œæˆ‘å–æ¶ˆ",
                class: "cancel-btn",
                onClick: () => {},
              },
              { text: "æˆ‘çŸ¥é“äº†", class: "neutral-btn", onClick: () => {} },
              { text: "é€™ä¹Ÿå¤ªçˆ›äº†ï¼Œå¼„å¥½ä¸€é»", class: "confirm-btn", onClick: step3 },
            ]);
          }
          function step3() {
            showModal("Cheeky fuckerï¼Œè¦å¿«åˆä¸çµ¦éŒ¢æ€•ä¸æ˜¯çª®å­¸ç”Ÿå°ˆæ¡ˆåˆ°æœ€å¾Œä¸€å¤©åœ¨æ‰¾äººå¹«å¿™è¶•ä½œæ¥­å§ï¼Œå“ªé‚Šæ¶¼å¿«å“ªé‚Šå»ğŸ˜…ğŸ–•", [
              {
                text: "ï¼Ÿ",
                class: "cancel-btn",
                onClick: disablePage,
              },
            ]);
          }
          step1();
          return;
        }
      }

      if (selected.length === 3) {
        showModal("ä½ ç¢ºå®šè¦é€™æ¨£è¦æ±‚ï¼Ÿ", [
          {
            text: "æˆ‘ç¢ºå®š",
            class: "confirm-btn",
            onClick: () => {
              showModal("Impossible. Go to hell.ğŸ˜…ğŸ–•", [
                {
                  text: "ï¼Ÿ",
                  class: "cancel-btn",
                  onClick: disablePage,
                },
              ]);
            },
          },
          { text: "æˆ‘å†æƒ³æƒ³", class: "neutral-btn", onClick: () => {} },
        ]);
      }
    }
  </script>
</body>
</html>
